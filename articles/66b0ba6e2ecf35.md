---
title: "ğŸ‹ ThemeExtensionã‚’æ´»ç”¨ã—ã¦è¤‡é›‘ãªãƒ‡ã‚¶ã‚¤ãƒ³è¦ä»¶ã«å¯¾å¿œã™ã‚‹"
emoji: "ğŸ‹"
type: "tech"
topics:
  - "flutter"
  - "design"
  - "dart"
  - "extension"
  - "theme"
published: false
publication_name: "arsaga"
---

## ã¯ã˜ã‚ã«
Flutterã¯ã‚¢ãƒ—ãƒªã§çµ±ä¸€çš„ãªãƒ‡ã‚¶ã‚¤ãƒ³ã‚’ä½œæˆã™ã‚‹ãŸã‚ã«Themeã¨ã„ã†ã‚¯ãƒ©ã‚¹ãŒæä¾›ã•ã‚Œã¦ã„ã¾ã™ã€‚Themeã‚’ç”¨ã„ã‚‹ã“ã¨ã§ã€ãƒ‡ã‚¶ã‚¤ãƒ³ã®å¤‰æ›´ã‚’æœ€å°é™ã«æŠ‘ãˆãŸã‚Šã€ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã®å¯¾å¿œã‚’ç°¡å˜ã«è¡Œã†ã“ã¨ãŒå‡ºæ¥ã¾ã™ã€‚

https://docs.flutter.dev/cookbook/design/themes
https://itome.team/blog/2019/12/flutter-advent-calendar-day12/

ã—ã‹ã—ã€ã‚¢ãƒ—ãƒªã®è¦æ¨¡ã‚„ãƒ‡ã‚¶ã‚¤ãƒ³ãŒè¤‡é›‘ã«ãªã‚‹ã«ã¤ã‚Œã¦Flutteræ¨™æº–ã®Themeã ã‘ã§ã¯ãƒ‡ã‚¶ã‚¤ãƒ³è¦ä»¶ã‚’æº€ãŸã™ã“ã¨ãŒé›£ã—ã„å ´åˆãŒã‚ã‚Šã¾ã™ã€‚

## æ¨™æº–Themeã®èª²é¡Œ

ä¾‹ãˆã°ã€ãƒãƒ£ãƒƒãƒˆç”»é¢ã«ãŠã„ã¦ãƒ¦ãƒ¼ã‚¶ã®ç¨®é¡ã«ã‚ˆã£ã¦ãƒãƒ£ãƒƒãƒˆãƒãƒ–ãƒ«ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’å¤‰æ›´ã™ã‚‹ã¨ã„ã£ãŸè¦ä»¶ãŒã‚ã‚‹ã¨ã—ã¾ã™ã€‚

![altãƒ†ã‚­ã‚¹ãƒˆ](https://storage.googleapis.com/zenn-user-upload/3f0aa3d125d3-20240113.png =300x)

```dart
class ChatMessage {
  ChatMessage({
    required this.message,
    required this.isMe,
  });

  String message;
  bool isMe;
}

class ChatBubble extends StatelessWidget {
  final ChatMessage msg;

  const ChatBubble({
    super.key,
    required this.msg,
  });

  @override
  Widget build(BuildContext context) {
    return Align(
      alignment: msg.isMe ? Alignment.centerRight : Alignment.centerLeft,
      child: Container(
        padding: const EdgeInsets.symmetric(
          horizontal: 15.0,
          vertical: 10.0,
        ),
        decoration: BoxDecoration(
          color: msg.isMe
              ? Theme.of(context).colorScheme.primary
              : Theme.of(context).colorScheme.secondary,
          borderRadius: BorderRadius.circular(20),
        ),
        child: Text(
          msg.message,
          style: Theme.of(context).textTheme.titleMedium?.copyWith(
                color: msg.isMe ? Colors.white : Colors.grey[400],
              ),
        ),
      ),
    );
  }
}

// MaterialAppéƒ¨åˆ†
      theme: ThemeData(
        useMaterial3: true,
        textTheme: const TextTheme(
          titleMedium: TextStyle(
            color: Colors.white,
            fontWeight: FontWeight.bold,
          ),
        ),
      ),
```

`isMe`ã§è‡ªåˆ†ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‹ç›¸æ‰‹ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‹ã‚’åˆ¤åˆ¥ã—ã¦ã‚¹ã‚¿ã‚¤ãƒ«ã‚’å¤‰æ›´ã—ã¦ã„ã¾ã™ã€‚

ã¾ãšãƒãƒ£ãƒƒãƒˆãƒãƒ–ãƒ«ã®èƒŒæ™¯è‰²éƒ¨åˆ†ã§ã™ãŒã€ã‚‚ã—colorSchemeãŒå¤‰æ›´ãªã£ãŸå ´åˆã€å½“ç„¶ã§ã™ãŒãƒãƒ£ãƒƒãƒˆãƒãƒ–ãƒ«ã®èƒŒæ™¯è‰²ã‚‚å¤‰æ›´ã•ã‚Œã¾ã™ã€‚

```dart
color: msg.isMe
    ? Theme.of(context).colorScheme.primary
    : Theme.of(context).colorScheme.secondary,
```

ã“ã‚ŒãŒæ„å›³ã—ãŸå¤‰æ›´ã§ã‚ã‚Œã°è‰¯ã„ã§ã™ãŒãƒãƒ£ãƒƒãƒˆãƒãƒ–ãƒ«ã®è‰²ã¯å¤‰ãˆãšã«colorSchemeã‚’å¤‰æ›´ã—ãŸã‹ã£ãŸå ´åˆã¯å½“ç„¶æ„å›³ã—ãªã„ãƒã‚°ã«ãªã‚Šã€çµå±€ã“ã‚Œã‚’é˜²ããŸã‚ã«Viewã«ç›´æ¥è‰²ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã«ãªã‚‹ã¨æ€ã„ã¾ã™ã€‚

ã¾ãŸã€ãƒ†ã‚­ã‚¹ãƒˆã®ã‚«ãƒ©ãƒ¼å¤‰æ›´éƒ¨åˆ†ã«ã¤ã„ã¦ã¯Themeã§è¨­å®šã—ãŸtitleMediumã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ã‚¹ã‚¿ã‚¤ãƒ«ã«å¯¾ã—ã¦copyWithã§å‹•çš„ã«è‰²ã‚’å¤‰æ›´ã—ã¦ã„ã¾ã™ã€‚

```dart
style: Theme.of(context).textTheme.titleMedium?.copyWith(
      color: msg.isMe ? Colors.white : Colors.grey[400],
    ),
```

ã“ã‚Œã ã¨çµå±€ChatBubbleå†…ã«è‰²ã‚’ç›´æ¥æŒ‡å®šã™ã‚‹ã“ã¨ã«ãªã‚Šã€Themeå®Œçµã§ã‚¹ã‚¿ã‚¤ãƒ«ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ãŒã§ããªããªã£ã¦ã—ã¾ã„ã¾ã™ã€‚æ¨™æº–ã®Themeã¯ã“ã†ã„ã£ãŸå‹•çš„ã«ã‚¹ã‚¿ã‚¤ãƒ«ã‚’å¤‰æ›´ã™ã‚‹ã¨ã„ã£ãŸã“ã¨ãŒå‡ºæ¥ã¾ã›ã‚“ã€‚

ã‚‚ã—ã“ã®çŠ¶æ…‹ã§ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã®å¯¾å¿œãŒè¿½åŠ ã«ãªã£ãŸã‚Šã€ç¬¬ä¸‰è€…ã‚‚ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ã‚Œã‚‹ã‚ˆã†ã«ã—ã¦ã‚¹ã‚¿ã‚¤ãƒ«ã‚‚å¤‰æ›´ã—ãŸã„ã¨ã„ã£ãŸä»•æ§˜ãŒè¿½åŠ ã«ãªã£ãŸå ´åˆã€ã•ã‚‰ã«ViewãŒè¤‡é›‘ã«ãªã‚Šä¿å®ˆãŒå›°é›£ã«ãªã‚Šã¾ã™ã€‚å¯èƒ½ã§ã‚ã‚Œã°Viewã«ã‚¹ã‚¿ã‚¤ãƒ«ã¯æŒ‡å®šã›ãšThemeå®Œçµã§ã‚¹ã‚¿ã‚¤ãƒ«ã‚’æŒ‡å®šã—ãŸã„ã¨ã“ã‚ã§ã™ã€‚

ã“ã®ã‚ˆã†ãªã‚¢ãƒ—ãƒªã®è¤‡é›‘ãªãƒ‡ã‚¶ã‚¤ãƒ³ã«å¯¾å¿œã™ã‚‹ãŸã‚ã€Flutter3.0ã‹ã‚‰**ThemeExtension**ã¨ã„ã†APIãŒè¿½åŠ ã•ã‚Œã¾ã—ãŸã€‚ThemeExtensionã‚’æ´»ç”¨ã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã‚¢ãƒ—ãƒªç‹¬è‡ªã®ãƒ‡ã‚¶ã‚¤ãƒ³è¦ä»¶ã«æ²¿ã£ãŸé–‹ç™ºã‚’è¡Œã†ã“ã¨ãŒå‡ºæ¥ã¾ã™ã€‚

https://www.youtube.com/watch?v=8-szcYzFVao
https://main-api.flutter.dev/flutter/material/ThemeExtension-class.html

## ThemeExtensionã¨ã¯ï¼Ÿ

ThemeExtensionã¯ã€æ¨™æº–ã®Themeã‚’æ‹¡å¼µå¯èƒ½ã«ã—ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ThemeDataã«ã¯ãªã„è¿½åŠ ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚„ã‚¹ã‚¿ã‚¤ãƒ«ã‚’å®šç¾©ã™ã‚‹ã“ã¨ãŒå‡ºæ¥ã¾ã™ã€‚å…ˆã»ã©ã®ãƒãƒ£ãƒƒãƒˆãƒãƒ–ãƒ«ã®ä¾‹ã®ã‚ˆã†å‹•çš„ã«ã‚¹ã‚¿ã‚¤ãƒ«ã‚’å¤‰æ›´ã—ãŸã„ã¨ã„ã£ãŸè¦ä»¶ã‚‚Themeã®ã¿ã§å®Ÿç¾ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

ThemeExtensionã®ä½¿ã„æ–¹ã«ã¤ã„ã¦ã¯ã™ã§ã«è©³ã—ãæ›¸ã‹ã‚Œã¦ã„ã‚‹è¨˜äº‹ãŒå­˜åœ¨ã™ã‚‹ã®ã§ã“ã®è¨˜äº‹ã§ã¯è§£èª¬ã—ã¾ã›ã‚“ã€‚

https://lab.mo-t.com/blog/flutter-decoding-theme-extension
https://blog.flutteruniv.com/flutter-themeextension/

## ãƒãƒ£ãƒƒãƒˆãƒãƒ–ãƒ«ã«ThemeExtensionã‚’é©ç”¨ã™ã‚‹
å…ˆã»ã©ã®ãƒãƒ£ãƒƒãƒˆãƒãƒ–ãƒ«ã«ThemeExtensionã‚’é©ç”¨ã—ã¦ã„ãã¾ã™ã€‚

### 1. ThemeExtensionç¶™æ‰¿ã‚¯ãƒ©ã‚¹ã‚’ä½œæˆã™ã‚‹
ä»Šå›ã¯å„ãƒ¦ãƒ¼ã‚¶ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®èƒŒæ™¯ã¨ãƒ†ã‚­ã‚¹ãƒˆã‚¹ã‚¿ã‚¤ãƒ«ã‚’å¤‰æ›´ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚ThemeExtensionã‚’ä½¿ç”¨ã™ã‚‹ãŸã‚ã«ã¯ThemeExtensionã‚’ç¶™æ‰¿ã—ãŸã‚¯ãƒ©ã‚¹ã‚’ä½œæˆã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

```dart
class ChatBubbleTheme extends ThemeExtension<ChatBubbleTheme> {
  final Color myMessageBackgroundColor;
  final Color otherMessageBackgroundColor;
  final TextStyle myMessageTextStyle;
  final TextStyle otherMessageTextStyle;

  ChatBubbleTheme({
    required this.myMessageBackgroundColor,
    required this.otherMessageBackgroundColor,
    required this.myMessageTextStyle,
    required this.otherMessageTextStyle,
  });

  @override
  ChatBubbleTheme copyWith({
    Color? myMessageBackgroundColor,
    Color? otherMessageBackgroundColor,
    TextStyle? myMessageTextStyle,
    TextStyle? otherMessageTextStyle,
  }) {
    return ChatBubbleTheme(
      myMessageBackgroundColor:
          myMessageBackgroundColor ?? this.myMessageBackgroundColor,
      otherMessageBackgroundColor:
          otherMessageBackgroundColor ?? this.otherMessageBackgroundColor,
      myMessageTextStyle: myMessageTextStyle ?? this.myMessageTextStyle,
      otherMessageTextStyle:
          otherMessageTextStyle ?? this.otherMessageTextStyle,
    );
  }

  @override
  ChatBubbleTheme lerp(ThemeExtension<ChatBubbleTheme>? other, double t) {
    if (other is! ChatBubbleTheme) {
      return this;
    }
    return ChatBubbleTheme(
      myMessageBackgroundColor: Color.lerp(
          myMessageBackgroundColor, other.myMessageBackgroundColor, t)!,
      otherMessageBackgroundColor: Color.lerp(
          otherMessageBackgroundColor, other.otherMessageBackgroundColor, t)!,
      myMessageTextStyle:
          TextStyle.lerp(myMessageTextStyle, other.myMessageTextStyle, t)!,
      otherMessageTextStyle: TextStyle.lerp(
          otherMessageTextStyle, other.otherMessageTextStyle, t)!,
    );
  }
}
```
é•·ã„ã—è¤‡é›‘ã§ã™ã­...
ãŸã ã€å®Ÿéš›ã¯ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ã‚³ãƒ”ãƒ¼ã™ã‚‹`copyWith`ãƒ¡ã‚½ãƒƒãƒ‰ã¨æ»‘ã‚‰ã‹ãªã‚¹ã‚¿ã‚¤ãƒ«ã®å¤‰æ›´ã‚’ä½œã‚Šå‡ºã™`lerp`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’overrideã—ã¦å®Ÿè£…ã—ã¦ã„ã‚‹ã ã‘ãªã®ã§ã€ç‰¹ã«ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ãŒå¿…è¦ã¨ã‹ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

### 2. ThemeExtensionç¶™æ‰¿ã‚¯ãƒ©ã‚¹ã‚’ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«é©ç”¨ã™ã‚‹

ChatBubbleã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«å…ˆã»ã©ä½œæˆã—ãŸThemeExtensionç¶™æ‰¿ã‚¯ãƒ©ã‚¹ã‚’ä½œæˆã—ã¾ã™ã€‚

```dart
class ChatBubble extends StatelessWidget {
  final ChatMessage msg;

  const ChatBubble({
    super.key,
    required this.msg,
    this.style,
  });

  final ChatBubbleTheme? style;

  @override
  Widget build(BuildContext context) {
    final chatBubbleTheme = Theme.of(context).extension<ChatBubbleTheme>();
    final myMessageBackgroundColor = style?.myMessageBackgroundColor ??
        chatBubbleTheme?.myMessageBackgroundColor;
    final otherMessageBackgroundColor = style?.otherMessageBackgroundColor ??
        chatBubbleTheme?.otherMessageBackgroundColor;
    final myMessageTextStyle =
        style?.myMessageTextStyle ?? chatBubbleTheme?.myMessageTextStyle;
    final otherMessageTextStyle =
        style?.otherMessageTextStyle ?? chatBubbleTheme?.otherMessageTextStyle;

    return Align(
      alignment: msg.isMe ? Alignment.centerRight : Alignment.centerLeft,
      child: Container(
        padding: const EdgeInsets.symmetric(
          horizontal: 15.0,
          vertical: 10.0,
        ),
        decoration: BoxDecoration(
          color:
              msg.isMe ? myMessageBackgroundColor : otherMessageBackgroundColor,
          borderRadius: BorderRadius.circular(20),
        ),
        child: Text(
          msg.message,
          style: msg.isMe ? myMessageTextStyle : otherMessageTextStyle,
        ),
      ),
    );
  }
}
```

å‘½åãŒå„ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«é©ã—ãŸã‚‚ã®ã«ãªã£ã¦ã„ã‚‹ã®ã§å¯èª­æ€§ã®é«˜ã„ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã«ãªã‚Šã¾ã—ãŸã€‚

### 3. MaterialAppã«ThemeExtensionã®è¨­å®šè¿½åŠ 

ThemeExtensionç¶™æ‰¿ã‚¯ãƒ©ã‚¹ã‚’ThemeDataã®extensionsã«æŒ‡å®šã—ã¾ã™ã€‚

```dart
    return MaterialApp(
      title: 'ThemeExtension Sample',
      theme: ThemeData(
        useMaterial3: true,
        extensions: <ThemeExtension>[
          ChatBubbleTheme(
            myMessageBackgroundColor: Colors.teal,
            otherMessageBackgroundColor: Colors.orange,
            myMessageTextStyle: const TextStyle(
              color: Color.fromARGB(255, 51, 66, 65),
              fontWeight: FontWeight.bold,
            ),
            otherMessageTextStyle: const TextStyle(
              color: Color.fromARGB(255, 255, 248, 239),
              fontWeight: FontWeight.bold,
            ),
          )
        ],
      ),
      home: ChatScreen(),
    );
```

ä»¥ä¸Šã§ThemeExtensionã®è¨­å®šãŒå®Œäº†ã§ã™ã€‚
ãƒãƒ£ãƒƒãƒˆãƒãƒ–ãƒ«ã®ã‚¹ã‚¿ã‚¤ãƒ«ãŒå¤‰æ›´ã•ã‚ŒãŸã‚Šã€æ–°ã—ãã‚¹ã‚¿ã‚¤ãƒ«ã‚’è¿½åŠ ã—ãŸã„å ´åˆã¯ã“ã®`ChatBubbleTheme`ã®ã¿ã‚’è¦‹ã‚Œã°ã„ã„ã®ã§ã€ä¿å®ˆãŒã‹ãªã‚Šæ¥½ã«ãªã‚Šã¾ã—ãŸã€‚

![altãƒ†ã‚­ã‚¹ãƒˆ](https://storage.googleapis.com/zenn-user-upload/e9430ead0932-20240113.png =300x)

## ã¾ã¨ã‚
ThemeExtensionã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã§ã€ä¸€è²«æ€§ã‚’ä¿ã¡ã¤ã¤ã€ã•ã¾ã–ã¾ãªãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‹ãƒ¼ã‚ºã«æŸ”è»Ÿã«å¯¾å¿œã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚è¤‡é›‘ãªãƒ‡ã‚¶ã‚¤ãƒ³ã®åæ˜ ã«ã¤ã„ã¦ãŠæ‚©ã¿ã®æ–¹ã¯ãœã²å°å…¥ã—ã¦ã¿ã¦ãã ã•ã„ï¼

ã„ã‚„ã§ã‚‚ã‚„ã£ã±ã‚Šã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰é•·ã„ã—å°å…¥ã‚³ã‚¹ãƒˆé«˜ã„ã€‚
ãã‚“ãªæ–¹ã«ã¯ä¸‹è¨˜ã®è¨˜äº‹ã‚’ãŠå‹§ã‚ã—ã¾ã™ï¼
https://zenn.dev/arsaga/articles/09bc0e213edf3e

## å‚è€ƒ
https://lab.mo-t.com/blog/flutter-decoding-theme-extension
https://blog.flutteruniv.com/flutter-themeextension/
