---
title: "Flutterプロジェクトのiosディレクトリを理解する"
emoji: "🦜"
type: "tech"
topics:
  - "flutter"
  - "ios"
  - "mobile"
published: false
---

Flutterプロジェクトのiosディレクトリについての理解が薄いため、メモ程度に書き留めていきます。ChatGPTさんに聞きながら書いていきます。

## Flutter
iOS向けのFlutterエンジンとその関連リソースを含むディレクトリです。

### 1. AppFrameworkInfo.plist

### 2. Debug.xcconfig

### 3. Release.xcconfig


## Runner
このディレクトリ内の重要なファイル（AppDelegate.swift、Info.plistなど）の役割を解説します。

![](https://storage.googleapis.com/zenn-user-upload/f145a492a1d1-20230519.png)


### 1. Assets.xcassets
iOSアプリケーションのアイコンや画像リソースを保存するディレクトリです。

![](https://storage.googleapis.com/zenn-user-upload/70c0c7807a1c-20230519.png)


例えば、アプリのアイコンを設定する[flutter_launcher_icons](https://pub.dev/packages/flutter_launcher_icons)を使用してアプリのアイコンを生成した場合は、***Assets.xcassets/AppIcon.appiconset/*** ディレクトリ内にアプリアイコン用の画像ファイルが配置されます。

また、アプリを起動した際に表示されるスプラッシュ画像の実装によく使用される[flutter_native_splash](https://pub.dev/packages/flutter_native_splash)でスプラッシュ画像を生成した場合は、***Assets.xcassets/LaunchImage.imageset/*** ディレクトリ内にスプラッシュ画像用のファイルが配置されます。 


### 2. Base.lproj
Base.lprojディレクトリは、iOSプロジェクト内で基本的な（またはデフォルトの）ローカライズ（国際化）リソースを管理するために使用されています。

![](https://storage.googleapis.com/zenn-user-upload/00626bbf62b9-20230519.png)


iOS開発では、異なる言語や地域向けのリソースを個々の.lprojディレクトリに保存します。それぞれのディレクトリは特定のロケール（言語または地域）に対応しています。たとえば、スペイン語のリソースはes.lproj、フランス語のリソースはfr.lprojなどとなります。

一方、Base.lprojは基本的な（またはデフォルトの）ローカライズリソースを管理します。具体的には、アプリケーションのユーザインターフェース（UI）のレイアウトを定義するStoryboardファイルや、各種のローカライズ文字列を定義するStringsファイルがこのディレクトリに保存されます。

FlutterプロジェクトのBase.lprojディレクトリには通常、以下の2つのファイルが含まれています。

LaunchScreen.storyboard: アプリの起動画面を定義します。これはアプリが起動するときに最初に表示される画面です。
Main.storyboard: アプリのメインインターフェースを定義します。Flutterアプリでは通常、このファイルは空です（FlutterエンジンがUIを制御するため）。
したがって、Base.lprojディレクトリはiOSアプリのローカライズとUIのレイアウトに重要な役割を果たします。


Flutterプロジェクトにおいて、Base.lprojディレクトリを直接編集することは少ないと思いますが、例えば、スプラッシュ画面を独自でカスタマイズしたい場合にアプリの起動画面（LaunchScreen.storyboard）を直接このファイルを編集することになると思います。
（通常は[flutter_native_splash](https://pub.dev/packages/flutter_native_splash)といった便利なパッケージが自動でファイルを編集してくれる）

試しにスプラッシュ画面の背景色を変えてみました。

```LaunchScreen.storyboard
<!-- red部分を1から100に変更 -->
<color key="backgroundColor" red="100" green="1" blue="1" alpha="1" colorSpace="custom" customColorSpace="sRGB" />
```

![altテキスト](https://storage.googleapis.com/zenn-user-upload/5678721ea9a5-20230519.png =250x)

<br><br><br>

### 3. AppDelegate.swift
AppDelegate.swiftはiOSアプリのエントリーポイントで、アプリのライフサイクルやバックグラウンドからの復帰、他アプリからの通信等を管理します。

https://tech.amefure.com/swift-app-delegate
https://qiita.com/Howasuto/items/b362991fafd8b190e260

iOS特有の機能やサードパーティ製のiOSライブラリをFlutterアプリで使用する際に使用するファイルです。Flutterプロジェクト作成時は下記のようになっています。

:::details AppDelegate.swift
```swift
import UIKit
import Flutter

@UIApplicationMain
@objc class AppDelegate: FlutterAppDelegate {
  // アプリ起動時に実行
  override func application(
    _ application: UIApplication,
    didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?
  ) -> Bool {
    GeneratedPluginRegistrant.register(with: self)
    return super.application(application, didFinishLaunchingWithOptions: launchOptions)
  }
}

```
:::


例えばFlutterのMethod Channelを使ってデバイス情報を取得するコードを書く場合、下記のようにAppDelegate.swiftにソースコードを追加します。

```swift
import UIKit
import Flutter

@UIApplicationMain
@objc class AppDelegate: FlutterAppDelegate {
  override func application(
    _ application: UIApplication,
    didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?
  ) -> Bool {
    GeneratedPluginRegistrant.register(with: self)

    let controller : FlutterViewController = window?.rootViewController as! FlutterViewController
    let deviceInfoChannel = FlutterMethodChannel(name: "samples.flutter.dev/deviceInfo",
                                                  binaryMessenger: controller.binaryMessenger)
    deviceInfoChannel.setMethodCallHandler({
      (call: FlutterMethodCall, result: @escaping FlutterResult) -> Void in
      switch call.method {
      case "getDeviceInfo":
        let deviceName = self.getDeviceInfo()
        result(deviceName)
      default:
        result(FlutterMethodNotImplemented)
      }
    })

    return super.application(application, didFinishLaunchingWithOptions: launchOptions)
  }
　　　// デバイス情報を取得するためのメソッドを定義
      private func getDeviceInfo() -> String {
        let deviceName = UIDevice.current.systemName
        return deviceName
    }
}

```

// 最後の説明を追加する

### 4. Info.plist

Info.plistは、iOSアプリケーションに関する重要な設定情報を保持するためのファイルです。基本的にはキーと値のペアのリストで、アプリケーションの名前、バージョン、アイコンのファイル名、起動画面の設定、対応するデバイスの向き、アクセス許可など、アプリケーションに関する様々な設定を含むことができます。

:::details Info.plist
```swift
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
	<key>CADisableMinimumFrameDurationOnPhone</key>
	<true/>
	<key>CFBundleDevelopmentRegion</key>
	<string>$(DEVELOPMENT_LANGUAGE)</string>
	<key>CFBundleDisplayName</key>
	<string>Flutter Base</string>
	<key>CFBundleExecutable</key>
	<string>$(EXECUTABLE_NAME)</string>
	<key>CFBundleIdentifier</key>
	<string>$(PRODUCT_BUNDLE_IDENTIFIER)</string>
	<key>CFBundleInfoDictionaryVersion</key>
	<string>6.0</string>
	<key>CFBundleName</key>
	<string>flutter_base</string>
	<key>CFBundlePackageType</key>
	<string>APPL</string>
	<key>CFBundleShortVersionString</key>
	<string>$(FLUTTER_BUILD_NAME)</string>
	<key>CFBundleSignature</key>
	<string>????</string>
	<key>CFBundleVersion</key>
	<string>$(FLUTTER_BUILD_NUMBER)</string>
	<key>LSRequiresIPhoneOS</key>
	<true/>
	<key>UIApplicationSupportsIndirectInputEvents</key>
	<true/>
	<key>UILaunchStoryboardName</key>
	<string>LaunchScreen</string>
	<key>UIMainStoryboardFile</key>
	<string>Main</string>
	<key>UISupportedInterfaceOrientations</key>
	<array>
		<string>UIInterfaceOrientationPortrait</string>
		<string>UIInterfaceOrientationLandscapeLeft</string>
		<string>UIInterfaceOrientationLandscapeRight</string>
	</array>
	<key>UISupportedInterfaceOrientations~ipad</key>
	<array>
		<string>UIInterfaceOrientationPortrait</string>
		<string>UIInterfaceOrientationPortraitUpsideDown</string>
		<string>UIInterfaceOrientationLandscapeLeft</string>
		<string>UIInterfaceOrientationLandscapeRight</string>
	</array>
	<key>UIViewControllerBasedStatusBarAppearance</key>
	<false/>
</dict>
</plist>

```
:::

主要なキーについて説明していきます。

| キー | 説明 |
| ---- | ---- |
| CFBundleDevelopmentRegion | アプリの開発地域が指定 |
| CFBundleDisplayName | アプリの表示名。デバイスにインストールされたアプリ名の表示に使われます |
| CFBundleIdentifier | アプリを識別する際に使用される一意のID |
| CFBundleName | アプリ名 |
| CFBundleShortVersionString | アプリの公開バージョン。AppStoreに表示されるバージョン |
| CFBundleVersion | アプリのビルドバージョン。iTunes Connectにバイナリをアップロードするたびにインクリメントする必要がある。 |
| UILaunchStoryboardName | 起動画面に表示するstoryboardファイルを指定。デフォルトでBase.lprojディレクトリのLaunchScreen.storyboardが指定されています。|
| UIMainStoryboardFile | メインのstoryboardファイルを指定。 デフォルトでBase.lprojディレクトリのMain.storyboardが指定されています。|
| UISupportedInterfaceOrientations | 対応するデバイスの向きを指定 |

上記に加え、プライバシーに関連する機能（写真ブラウザへのアクセス）を使用する場合、それに対応するキー・バリューを追加することでユーザーに適切な許可のダイアログ表示を行うことができます。

![](https://storage.googleapis.com/zenn-user-upload/afca9fa3a53d-20230521.jpg)

### 5. Runner-Bridging-Header.h
SwiftからObjective-Cのコードを使用するためのファイルです。
基本的に触ることはなさそうです。

## Runner.xcodeproj

## Runner.xcworkspace

## RunnerTests

RunnerTestsは、FlutterプロジェクトにおいてiOSアプリケーションのユニットテストを実行するためのテストターゲットです。テストコードはSwiftまたはObjective-Cで書かれ、Xcodeのテストランナーを使って実行されます。テストスイートは通常、プロジェクトのios/RunnerTestsディレクトリに配置されます。

RunnerTestsでは、アプリケーションの特定の部分や機能に対してテストケースを作成し、その振る舞いを検証します。これにより、新しい機能の追加や既存のコードの修正がアプリケーションの期待される動作に影響を与えていないことを確認できます。

テストコードは通常、アサーションを使用して検証を行います。アサーションは、ある条件が真であることを確認するステートメントです。もしアサーションが失敗すると、それはテストケースが失敗したことを意味し、何かが期待された振る舞いと異なることを示します。

注意点として、RunnerTestsはアプリケーションの単体テストを行うためのものであり、UIテスト（画面遷移やユーザーインタラクションなど）やパフォーマンステスト（アプリの応答性やリソース使用量など）を行うためのものではありません。これらの高度なテストは通常、別のテストフレームワークを使用して行います。

## .gitignore
:::details .gitignore
```.gitignore
**/dgph
*.mode1v3
*.mode2v3
*.moved-aside
*.pbxuser
*.perspectivev3
**/*sync/
.sconsign.dblite
.tags*
**/.vagrant/
**/DerivedData/
Icon?
**/Pods/
**/.symlinks/
profile
xcuserdata
**/.generated/
Flutter/App.framework
Flutter/Flutter.framework
Flutter/Flutter.podspec
Flutter/Generated.xcconfig
Flutter/ephemeral/
Flutter/app.flx
Flutter/app.zip
Flutter/flutter_assets/
Flutter/flutter_export_environment.sh
ServiceDefinitions.json
Runner/GeneratedPluginRegistrant.*

# Exceptions to above rules.
!default.mode1v3
!default.mode2v3
!default.pbxuser
!default.perspectivev3


```
:::

Gitのバージョン管理対象外にするファイルやディレクトリを指定するファイルです。Flutterプロジェクトのトップレベルに.gitignoreファイルが配置されていますが、こちらはiOSに関連するファイルやディレクトリを指定します。トップレベルの.gitignoreではなく、iosディレクトリに.gitignoreを配置することによってiosディレクトリと子ディレクトリのみ適用させることができます。

## Podfile

:::details Podfile
```Podfile
# Uncomment this line to define a global platform for your project
# platform :ios, '11.0'

# CocoaPods analytics sends network stats synchronously affecting flutter build latency.
ENV['COCOAPODS_DISABLE_STATS'] = 'true'

project 'Runner', {
  'Debug' => :debug,
  'Profile' => :release,
  'Release' => :release,
}

def flutter_root
  generated_xcode_build_settings_path = File.expand_path(File.join('..', 'Flutter', 'Generated.xcconfig'), __FILE__)
  unless File.exist?(generated_xcode_build_settings_path)
    raise "#{generated_xcode_build_settings_path} must exist. If you're running pod install manually, make sure flutter pub get is executed first"
  end

  File.foreach(generated_xcode_build_settings_path) do |line|
    matches = line.match(/FLUTTER_ROOT\=(.*)/)
    return matches[1].strip if matches
  end
  raise "FLUTTER_ROOT not found in #{generated_xcode_build_settings_path}. Try deleting Generated.xcconfig, then run flutter pub get"
end

require File.expand_path(File.join('packages', 'flutter_tools', 'bin', 'podhelper'), flutter_root)

flutter_ios_podfile_setup

target 'Runner' do
  use_frameworks!
  use_modular_headers!

  flutter_install_all_ios_pods File.dirname(File.realpath(__FILE__))
  target 'RunnerTests' do
    inherit! :search_paths
  end
end

post_install do |installer|
  installer.pods_project.targets.each do |target|
    flutter_additional_ios_build_settings(target)
  end
end

```
:::

## Podfile.lock

<br><br><br><br><br><br><br><br><br>

### Runner.xcworkspace

期限：21日までに記事を完成させる

メモ
・Flutterプロジェクトのiosディレクトリについて学ぶ
・初心者向け。Flutterからモバイルアプリ開発を始めたエンジニア。iosに関する知識が浅い駆け出し向け
・最後に読書からのフィードバックを求める
